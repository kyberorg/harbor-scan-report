name: "Development Workflow"

on:
  push:
    branches-ignore:
      - trunk

jobs:
  harbor-scan-report:
    name: Harbor Image Scan Report
    runs-on: ubuntu-latest

    steps:
      - name: Get
        id: current_branch
        run: echo "##[set-output name=branch;]$(echo ${GITHUB_REF#refs/heads/})"

      - name: Run Report
        uses: kyberorg/harbor-scan-report@${{ steps.current_branch.outputs.branch }}
        with:
          harbor-host: kio.ee
          harbor-robot: ${{ secrets.HARBOR_ROBOT }}
          harbor-token: ${{ secrets.HARBOR_TOKEN }}
          image: kio.ee/hub/redhat/ubi8:latest
          max-allowed-severity: high
